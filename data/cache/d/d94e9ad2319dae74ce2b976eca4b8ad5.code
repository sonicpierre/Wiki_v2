X <span class="sy0">=</span> img.<span class="me1">reshape</span><span class="br0">&#40;</span>-<span class="nu0">1</span><span class="sy0">,</span><span class="nu0">3</span><span class="br0">&#41;</span>
kmeans <span class="sy0">=</span> KMeans<span class="br0">&#40;</span>n_clusters<span class="sy0">=</span><span class="nu0">12</span><span class="br0">&#41;</span>.<span class="me1">fit</span><span class="br0">&#40;</span>X<span class="br0">&#41;</span>
segmented_img <span class="sy0">=</span> kmeans.<span class="me1">cluster_centers_</span><span class="br0">&#91;</span>kmeans.<span class="me1">labels_</span><span class="br0">&#93;</span>
segmented_img <span class="sy0">=</span> segmented_img.<span class="me1">reshape</span><span class="br0">&#40;</span>img.<span class="me1">shape</span><span class="br0">&#41;</span>
plt.<span class="me1">imshow</span><span class="br0">&#40;</span><span class="br0">&#40;</span>segmented_img * <span class="nu0">255</span><span class="br0">&#41;</span>.<span class="me1">astype</span><span class="br0">&#40;</span>np.<span class="me1">uint8</span><span class="br0">&#41;</span><span class="br0">&#41;</span>